<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet"/>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // Botones para minimizar y cerrar la ventana
   

  document.getElementById('close-btn').addEventListener('click', () => {
  require('electron').ipcRenderer.send('close-app');
});

      document.getElementById("launch-button").addEventListener("click", login);

      // Mostrar y ocultar pop-up de versiones
      document.getElementById('versions-button').addEventListener('click', () => {
        document.getElementById('version-popup').style.display = 'block';
      });

      // Mostrar y ocultar pop-up de configuración
      document.getElementById('settings-button').addEventListener('click', () => {
        document.getElementById('settings-popup').style.display = 'block';
      });
    });

    function login() {
      const username = document.getElementById("username").value;
      if (username) {
        saveConfig({ username: username });
        showMainContainer();
      } else {
        alert("Por favor, ingresa un nombre de usuario.");
      }
    }

    function showMainContainer() {
      document.getElementById("login-container").style.display = "none";
      document.getElementById("main-container").style.display = "block";
      loadMissions();
    }

    function saveConfig(data) {
      let config = localStorage.getItem('overmaster_config');
      if (!config) {
        config = {};
      } else {
        config = JSON.parse(config);
      }
      Object.assign(config, data);
      localStorage.setItem('overmaster_config', JSON.stringify(config));
    }
  </script>
</head>
<body>
  <div id="launcher-container">
    <button id="close-btn">Cerrar</button>           
    <div id="sidebar">
      <div id="user-info">
        <img id="skin-image" src="https://mineskin.eu/armor/bust/Valentinhere1/100.png
" alt="Skin"/>Valentinhere1

        <h3 style="color: white"></h3>
      </div>
      <button id="launch-button"><i class="bx bx-play-circle"></i> Lanzar Juego</button>
      <button id="versions-button"><i class="bx bx-layer"></i> Versiones</button>
      <button id="settings-button"><i class="bx bx-cog"></i> Configuración</button>
      <div id="loading-bar">
        <div id="progress"></div>
      </div>
    </div>

    <div id="content">
      <div class="titles">OverMaster - Launcher</div>
      <i id="alert-icon" class="bx bx-error-circle mission-icon"></i>
      <div id="mission-popup" style="display: none;">
        <div id="mission-content">
          <h2 id="mission-title"></h2>
          <p id="mission-type"></p>
          <p id="mission-body"></p>
          <ul id="mission-list"></ul>
          <i id="mission-icon"></i>
          <button id="close-mission-popup">Cerrar</button>
        </div>
      </div>
      <script>
      document.addEventListener("DOMContentLoaded", function() {
        // Referencias a los elementos del popup
        const missionPopup = document.getElementById('mission-popup');
        const missionTitle = document.getElementById('mission-title');
        const missionType = document.getElementById('mission-type');
        const missionBody = document.getElementById('mission-body');
        const missionList = document.getElementById('mission-list');
        const missionIcon = document.getElementById('mission-icon');
        const closeMissionPopup = document.getElementById('close-mission-popup');
      
        // Función para cargar el archivo JSON
        function loadMissionData() {
          fetch('event_file.json')
            .then(response => response.json())
            .then(data => {
              // Actualizar el contenido del popup con los datos de la misión
              missionTitle.textContent = data.titulo;
              missionType.textContent = data.tipo;
              missionBody.textContent = data.contenido;
      
              // Limpiar la lista antes de añadir nuevas entradas
              missionList.innerHTML = '';
      
              // Convertir la lista en un array y crear elementos <li>
              const items = data.lista.split(', ');
              items.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                missionList.appendChild(li);
              });
      
              // Actualizar el icono y el color
              missionIcon.className = `icon-${data.icon}`;
              missionIcon.style.color = data.icon_color;
      
              // Mostrar el popup
              missionPopup.style.display = 'block';
            })
            .catch(error => {
              console.error('Error al cargar el archivo JSON:', error);
            });
        }
      
        // Evento para cerrar el popup
        closeMissionPopup.addEventListener('click', function() {
          missionPopup.style.display = 'none';
        });
      
        // Evento para abrir el popup cuando el ícono de misiones sea clickeado
        document.getElementById('mission-icon').addEventListener('click', function() {
          loadMissionData();
        });
      });
    </script>

  <!-- Popup para Seleccionar Versión -->
  <div id="version-popup" class="popup" style="display:none;">
    <div class="popup-content">
      <h1>Seleccionar Versión</h1>
      <label><input type="radio" name="version" value="1.20.4 Fabric" /> 1.20.4 Fabric</label><br />
      <label><input type="radio" name="version" value="1.20.4 Forge" /> 1.20.4 Forge</label><br />
      <label><input type="radio" name="version" value="1.20.4 Vanilla" /> 1.20.4 Vanilla</label><br />
      <button onclick="saveVersion()">Guardar y Cerrar</button>
      <button onclick="closePopup('version-popup')">Volver</button>
    </div>
  </div>
  
<!-- Popup de inicio de sesión -->
<div id="login-popup">
  <iframe src="popup/cuenta.html" id="login-iframe" frameborder="0"></iframe>
  <button id="close-popup">Cerrar</button>
</div>

  <!-- Popup para Configuración -->
  <div id="settings-popup" class="popup" style="display:none;">
    <div class="popup-content">
      <h1>Configuración</h1>
      <button onclick="changeAccount()">Cambiar de Cuenta</button>
      <button onclick="changeLanguage()">Cambiar Idioma</button>
      <button onclick="closePopup('settings-popup')">Volver</button>
    </div>
  </div>
  <script>
  window.onload = function() {
    // Mostrar el popup de inicio de sesión cuando la página se carga
    const loginPopup = document.getElementById('login-popup');
    loginPopup.style.display = 'flex';
  
    // Cerrar el popup cuando el usuario presione el botón de cerrar
    const closeBtn = document.getElementById('close-popup');
    closeBtn.addEventListener('click', function() {
      loginPopup.style.display = 'none';
    });
  };
  
</script>
  <script>
    function closePopup(popupId) {
      document.getElementById(popupId).style.display = 'none';
    }

    function saveVersion() {
      const selectedVersion = document.querySelector('input[name="version"]:checked').value;
      localStorage.setItem('overmaster_selected_version', selectedVersion);
      alert("Versión seleccionada: " + selectedVersion);
      closePopup('version-popup');
    }

    function changeAccount() {
      alert("Cambiar de cuenta no implementado.");
    }

    function changeLanguage() {
      const currentLang = localStorage.getItem('overmaster_language') || 'es';
      const newLang = currentLang === 'es' ? 'en' : 'es';
      localStorage.setItem('overmaster_language', newLang);
      alert("Idioma cambiado a " + newLang);
    }


    function closeAllPopups() {
  document.querySelectorAll('.popup').forEach(popup => {
    popup.style.display = 'none';
  });
}

document.getElementById('versions-button').addEventListener('click', () => {
  closeAllPopups(); // Cierra todos los popups antes de abrir el nuevo
  document.getElementById('version-popup').style.display = 'block';
});

document.getElementById('settings-button').addEventListener('click', () => {
  closeAllPopups(); // Cierra todos los popups antes de abrir el nuevo
  document.getElementById('settings-popup').style.display = 'block';
});

  </script>

  <style>
    /* Estilos para los popups */
    .popup {
  position: absolute;
  top: 50px; /* Ajusta la posición según lo necesites */
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
}


    .popup-content {
      background-color: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    }
      </style></div></div>
</body>
</html>
